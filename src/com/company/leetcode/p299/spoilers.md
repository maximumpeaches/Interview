It has one pass implementation and possible bug if uoure not careful.