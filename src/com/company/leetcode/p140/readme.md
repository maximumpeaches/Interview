This is basically the same problem as #139.